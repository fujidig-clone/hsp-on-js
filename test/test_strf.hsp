is(strf("foo"), "foo")
is(strf("<%%>"), "<%>")
is(strf("<%s><%d><%f>", "hoge", 123, 3.14), "<hoge><123><3.140000>")
is(strf("<%s><%d><%f>", 42, 3.14, "hoge"), "<42><3><0.000000>")
----------------------------------------
is(strf("<%c>", '@'), "<@>")
is(strf("<%c><%5c><%-5c><%05c><%-05c>", 'A', 'B', 'C', 'D', 'E'), "<A><    B><C    ><0000D><E    >")
is(strf("<%s><%6.3s><%-6.3s><%06.3s><%-06.3s>", "abc", "hello", "hello", "hello", "hello"), "<abc><   hel><hel   ><000hel><hel   >")
----------------------------------------
is(strf("<%d><%d>", 42, -123), "<42><-123>")
is(strf("<%5d><%05d>", 123, 123), "<  123><00123>")
is(strf("<%+5d><%+.5d><%+05d>",  123,  123,  123), "< +123><+00123><+0123>")
is(strf("<%+5d><%+.5d><%+05d>", -123, -123, -123), "< -123><-00123><-0123>")
is(strf("<% 5d><% .5d><% 05d>",  123,  123,  123), "<  123>< 00123>< 0123>")
is(strf("<% 5d><% .5d><% 05d>", -123, -123, -123), "< -123><-00123><-0123>")
is(strf("<%-.5d><%-05d>", 123, 123), "<00123><123  >")
is(strf("<%8.5d><%-8.5d>", 123, 123),   "<   00123><00123   >")
is(strf("<%8.5d><%-8.5d>", -123, -123), "<  -00123><-00123  >")
is(strf("<%+d>", 0), "<+0>")
is(strf("<%1d><%.1d><%3.5d>", 123, 123, 123), "<123><123><00123>")
is(strf("%05.3d", 1), "  001")
----------------------------------------
is(strf("<%u><%+u><% u>", -1, 3, 3), "<4294967295><3><3>")
is(strf("<%x><%#x><%#x><%#5x><%#05x><%#.5x><%#-8.5x>", 255, 255, 0, 255, 255, 255, 255), "<ff><0xff><0>< 0xff><0x0ff><0x000ff><0x000ff >")
is(strf("<%#x><%#X>", 0xabc, 0xabc), "<0xabc><0XABC>")
is(strf("<%x><%o>", -1, -1), "<ffffffff><37777777777>")
is(strf("<%#o><%#o><%#.3o><%-#03o>", (1 * 8 + 2) * 8 + 3, 0, 1, 1), "<0123><0><001><01 >")
a = 0x80000000
is(strf("<%d><%u><%o><%x>", a, a, a, a), "<-2147483648><2147483648><20000000000><80000000>")
is(strf("<%p><%10p><%-10p><%020.10p>", 0, 0, 0, 0), "<00000000><  00000000><00000000  ><            00000000>")
----------------------------------------
is(strf("%+-@ %d", 111, 222), "@ 222")
is(strf("<%++", 111) + ">", "<>")
is(strf("<%d %c %d", 111, 0, 222) + ">", "<111 >")
----------------------------------------
is(strf("<%e>", 0), "<0.000000e+000>")

is(strf("<%13.3e>", 0),    "<   0.000e+000>")
is(strf("<%013.3e>", 0),   "<0000.000e+000>")
is(strf("<%+013.3e>", 0),  "<+000.000e+000>")
is(strf("<%+013.3e>", -1), "<-001.000e+000>")
is(strf("<% 013.3e>", 0),  "< 000.000e+000>")
is(strf("<% 013.3e>", -1), "<-001.000e+000>")
is(strf("<%-+013.3e>", 0), "<+0.000e+000  >")

is(strf("<%13.3E>", 0),    "<   0.000E+000>")
is(strf("<%013.3E>", 0),   "<0000.000E+000>")
is(strf("<%+013.3E>", 0),  "<+000.000E+000>")
is(strf("<%+013.3E>", -1), "<-001.000E+000>")
is(strf("<% 013.3E>", 0),  "< 000.000E+000>")
is(strf("<% 013.3E>", -1), "<-001.000E+000>")
is(strf("<%-+013.3E>", 0), "<+0.000E+000  >")
----------------------------------------
#include "hspmath.as"
is(strf("<%.50e>", DBL_MAX), "<1.79769313486231570000000000000000000000000000000000e+308>")
is(strf("<%.50e>", DBL_MIN), "<2.22507385850720140000000000000000000000000000000000e-308>")
is(strf("<%f>", 0), "<0.000000>")
is(strf("<%f>", DBL_MAX), "<179769313486231570000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.000000>")
----------------------------------------
is(strf("<%10.3f>", 0),    "<     0.000>")
is(strf("<%010.3f>", 0),   "<000000.000>")
is(strf("<%+010.3f>", 0),  "<+00000.000>")
is(strf("<%+010.3f>", -1), "<-00001.000>")
is(strf("<% 010.3f>", 0),  "< 00000.000>")
is(strf("<% 010.3f>", -1), "<-00001.000>")
is(strf("<%-+010.3f>", 0), "<+0.000    >")
----------------------------------------
is(strf("<%10.3g>", 0),    "<         0>")
is(strf("<%010.3g>", 0),   "<0000000000>")
is(strf("<%+010.3g>", 0),  "<+000000000>")
is(strf("<%+010.3g>", -1), "<-000000001>")
is(strf("<% 010.3g>", 0),  "< 000000000>")
is(strf("<% 010.3g>", -1), "<-000000001>")
is(strf("<%-+010.3g>", 0), "<+0        >")
----------------------------------------
is(strf("<%g><%g>", 1e-5, 1e-4), "<1e-005><0.0001>")
is(strf("<%g><%g>", 1e-3, 1e-2), "<0.001><0.01>")
is(strf("<%g><%g>", 1e-1, 1e+0), "<0.1><1>")
is(strf("<%g><%g>", 1e+1, 1e+2), "<10><100>")
is(strf("<%g><%g>", 1e+3, 1e+4), "<1000><10000>")
is(strf("<%g><%g>", 1e+5, 1e+6), "<100000><1e+006>")
----------------------------------------
val = sqrt(-1) ; NaN
is(strf("<%.0f><%.1f><%.2f>", val, val, val), "<-1><-1.$><-1.#J>")
is(strf("<%.3f><%.4f><%.5f>", val, val, val), "<-1.#IO><-1.#IND><-1.#IND0>")

is(strf("<%.0e><%.1e><%.2e>", val, val, val), "<-1e+000><-1.$e+000><-1.#Je+000>")
is(strf("<%.3e><%.4e><%.5e>", val, val, val), "<-1.#IOe+000><-1.#INDe+000><-1.#IND0e+000>")

is(strf("<%.1g><%.2g><%.3g>", val, val, val), "<-1><-1.$><-1.#J>")
is(strf("<%.4g><%.5g><%.6g>", val, val, val), "<-1.#IO><-1.#IND><-1.#IND>")
----------------------------------------
val = expf(999) ; Infinity
is(strf("<%.0f><%.1f><%.2f>", val, val, val), "<1><1.$><1.#J>")
is(strf("<%.3f><%.4f><%.5f>", val, val, val), "<1.#IO><1.#INF><1.#INF0>")
is(strf("<%.0e><%.1e><%.2e>", val, val, val), "<1e+000><1.$e+000><1.#Je+000>")
is(strf("<%.3e><%.4e><%.5e>", val, val, val), "<1.#IOe+000><1.#INFe+000><1.#INF0e+000>")
is(strf("<%.1g><%.2g><%.3g>", val, val, val), "<1><1.$><1.#J>")
is(strf("<%.4g><%.5g><%.6g>", val, val, val), "<1.#IO><1.#INF><1.#INF>")
----------------------------------------
val = -expf(999) ; -Infinity
is(strf("<%.0f><%.1f><%.2f>", val, val, val), "<-1><-1.$><-1.#J>")
is(strf("<%.3f><%.4f><%.5f>", val, val, val), "<-1.#IO><-1.#INF><-1.#INF0>")
is(strf("<%.0e><%.1e><%.2e>", val, val, val), "<-1e+000><-1.$e+000><-1.#Je+000>")
is(strf("<%.3e><%.4e><%.5e>", val, val, val), "<-1.#IOe+000><-1.#INFe+000><-1.#INF0e+000>")
is(strf("<%.1g><%.2g><%.3g>", val, val, val), "<-1><-1.$><-1.#J>")
is(strf("<%.4g><%.5g><%.6g>", val, val, val), "<-1.#IO><-1.#INF><-1.#INF>")
----------------------------------------
is(strf("<%.0f>", 0.5), "<1>")
is(strf("<%.0f>", 0.4), "<0>")
is(strf("<%.0f>", 9.5), "<10>")
is(strf("<%.0f>", 9.4), "<9>")
is(strf("<%.0f>", 99.5), "<100>")
is(strf("<%.0f>", 99.4), "<99>")

is(strf("<%.1f>", 0.05), "<0.1>")
is(strf("<%.1f>", 0.04), "<0.0>")
is(strf("<%.1f>", 0.951), "<1.0>")
is(strf("<%.1f>", 0.94), "<0.9>")
is(strf("<%.1f>", 9.951), "<10.0>")
is(strf("<%.1f>", 9.94), "<9.9>")
----------------------------------------
is(strf("<%.0f>", -0.4), "<-0>")
is(strf("<%.1f>", -0.04), "<-0.0>")
----------------------------------------
is(strf("<%.0f>", 123), "<123>")
is(strf("<%#.0f>", 123), "<123.>")

is(strf("<%.0e>", 1), "<1e+000>")
is(strf("<%#.0e>", 1), "<1.e+000>")
----------------------------------------
is(strf("<%f>", -0.9), "<-0.900000>")
is(strf("<%f>", -0.8), "<-0.800000>")
is(strf("<%f>", -0.7), "<-0.700000>")
is(strf("<%f>", -0.6), "<-0.600000>")
is(strf("<%f>", -0.5), "<-0.500000>")
is(strf("<%f>", -0.4), "<-0.400000>")
is(strf("<%f>", -0.3), "<-0.300000>")
is(strf("<%f>", -0.2), "<-0.200000>")
is(strf("<%f>", -0.1), "<-0.100000>")
is(strf("<%f>",  0.0), "<0.000000>")
is(strf("<%f>",  0.1), "<0.100000>")
is(strf("<%f>",  0.2), "<0.200000>")
is(strf("<%f>",  0.3), "<0.300000>")
is(strf("<%f>",  0.4), "<0.400000>")
is(strf("<%f>",  0.5), "<0.500000>")
is(strf("<%f>",  0.6), "<0.600000>")
is(strf("<%f>",  0.7), "<0.700000>")
is(strf("<%f>",  0.8), "<0.800000>")
is(strf("<%f>",  0.9), "<0.900000>")
----------------------------------------
a = 0.9999999999999999
is(a < 1, 1)
is(strf("<%.0f>", a), "<1>")
is(strf("<%.1f>", a), "<1.0>")
is(strf("<%.2f>", a), "<1.00>")

is(strf("<%.15f>", a), "<1.000000000000000>")
is(strf("<%.16f>", a), "<0.9999999999999999>")
is(strf("<%.17f>", a), "<0.99999999999999989>")
is(strf("<%.18f>", a), "<0.999999999999999890>")
----------------------------------------
is(strf("<%.2f>", 0.099), "<0.10>")
is(strf("<%.1f>", 0.99), "<1.0>")
is(strf("<%.0f>", 9.9), "<10>")
is(strf("<%.0f>", 999.99999), "<1000>")
is(strf("<%.1f>", 999.99999), "<1000.0>")
is(strf("<%.2f>", 999.99999), "<1000.00>")
is(strf("<%.3f>", 999.99999), "<1000.000>")
is(strf("<%.4f>", 999.99999), "<1000.0000>")
is(strf("<%.5f>", 999.99999), "<999.99999>")
----------------------------------------
is(strf("<%.1g>", 0.001234), strf("<%.3f>", 0.001234))
is(strf("<%.1g>", 0.001234), "<0.001>")

is(strf("<%.1g>", 0.012345), strf("<%.2f>", 0.012345))
is(strf("<%.1g>", 0.012345), "<0.01>")

is(strf("<%.1g>", 0.123456), strf("<%.1f>", 0.123456))
is(strf("<%.1g>", 0.123456), "<0.1>")

is(strf("<%.2g>", 1.234567), strf("<%.1f>", 1.234567))
is(strf("<%.2g>", 1.234567), "<1.2>")

is(strf("<%.3g>", 12.34567), strf("<%.1f>", 12.34567))
is(strf("<%.3g>", 12.34567), "<12.3>")

is(strf("<%.4g>", 123.4567), strf("<%.1f>", 123.4567))
is(strf("<%.4g>", 123.4567), "<123.5>")
----------------------------------------
is(strf("<%.1g>", 0.944444), strf("<%.1f>", 0.944444))
is(strf("<%.1g>", 0.944444), "<0.9>")

is(strf("<%.1g>", 0.955555), strf("<%.0f>", 0.955555))
is(strf("<%.1g>", 0.955555), "<1>")

is(strf("<%.2g>", 0.955555), strf("<%.2f>", 0.955555))
is(strf("<%.2g>", 0.955555), "<0.96>")
----------------------------------------
is(strf("<%.1g>", 0.094444), strf("<%.2f>", 0.094444))
is(strf("<%.1g>", 0.094444), "<0.09>")

is(strf("<%.1g>", 0.095555), strf("<%.1f>", 0.095555))
is(strf("<%.1g>", 0.095555), "<0.1>")

is(strf("<%.2g>", 0.095555), strf("<%.3f>", 0.095555))
is(strf("<%.2g>", 0.095555), "<0.096>")
----------------------------------------
is(strf("<%.1g>", 9.444444), strf("<%.0f>", 9.444444))
is(strf("<%.1g>", 9.444444), "<9>")

is(strf("<%.1g>", 9.555555), strf("<%.0e>", 9.555555))
is(strf("<%.1g>", 9.555555), "<1e+001>")

is(strf("<%.2g>", 9.555555), strf("<%.1f>", 9.555555))
is(strf("<%.2g>", 9.555555), "<9.6>")
----------------------------------------
is(strf("<%#.2g>", 99.4), strf("<%#.0f>", 99.4))
is(strf("<%#.2g>", 99.4), "<99.>")

is(strf("<%#.2g>", 99.5), strf("<%#.1e>", 99.5))
is(strf("<%#.2g>", 99.5), "<1.0e+002>")

is(strf("<%#.1g>", 99.5), strf("<%#.0e>", 99.5))
is(strf("<%#.1g>", 99.5), "<1.e+002>")
----------------------------------------
inf = expf(999)
is(strf("<%.3g>", inf), strf("<%.2f>", inf))
is(strf("<%.3g>", inf), "<1.#J>")

is(strf("<%.1g>", inf), strf("<%.0f>", inf))
is(strf("<%.1g>", inf), "<1>")

is(strf("<%#.3g>", 0.0), strf("<%#.3f>", 0.0))
is(strf("<%#.3g>", 0.0), "<0.000>")
----------------------------------------
#include "hspmath.as"
is(strf("<%.2g>", 123.4), strf("<%.1e>", 123.4))
is(strf("<%.2g>", 123.4), "<1.2e+002>")

is(strf("<%.300g>", DBL_MAX), strf("<%.16e>", DBL_MAX))
is(strf("<%.300g>", DBL_MAX), "<1.7976931348623157e+308>")

is(strf("<%.10g>", DBL_MIN), strf("<%.9e>", DBL_MIN))
is(strf("<%.10g>", DBL_MIN), "<2.225073859e-308>")

is(strf("<%.1g>", 1.23e-5), strf("<%.0e>", 1.23e-5))
is(strf("<%.1g>", 1.23e-5), "<1e-005>")
----------------------------------------
; %g prec 0 -> 1
is(strf("<%.0g>", 1.0), strf("<%.1g>", 1.0))
is(strf("<%.0g>", 10.0), strf("<%.1g>", 10.0))
is(strf("<%.0g>", 0.1), strf("<%.1g>", 0.1))
----------------------------------------
#include "hspmath.as"
is(strf("<%.0E>", 9.555555), "<1E+001>")
is(strf("<%.1G>", 9.555555), "<1E+001>")

is(strf("<%.16E>", DBL_MAX), "<1.7976931348623157E+308>")
is(strf("<%.300G>", DBL_MAX), "<1.7976931348623157E+308>")
----------------------------------------
#include "hspmath.as"
is(strf("<%#.1g>", 1), "<1.>")

prec = 400-log10(DBL_MAX)-1
is(strf("%#.400g", DBL_MAX), strf("%#."+prec+"f", DBL_MAX))

is(strf("%.3g", 1.0), "1")
is(strf("%#.3g", 1.0), "1.00")
